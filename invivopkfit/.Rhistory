p$data$Time
junk <- plot_conctime(PK.fit.table=PK.fit.table.1comp.new[[1]],
data.set=PK.fit.table.1comp.new[[2]],
model="1compartment")
p$data$Time
junk <- plot_conctime(PK.fit.table=PK.fit.table.1comp.test[[1]],
data.set=PK.fit.table.1comp.test[[2]],
model="1compartment")
traceback()
junk <- plot_conctime(PK.fit.table=PK.fit.table.1comp.test[[1]],
data.set=PK.fit.table.1comp.test[[2]],
model="1compartment")
bestfit.invivo$time
class(bestfit.invivo$time)
junk <- plot_conctime(PK.fit.table=PK.fit.table.1comp.test[[1]],
data.set=PK.fit.table.1comp.test[[2]],
model="1compartment")
p <- ggplot2::ggplot(data=this.compound.data) +
ggtitle(paste(this.compound," (",model,")",sep=""))
p
dev.new()
p
p<-p+         facet_wrap(vars(Dose.nominal.units.type)) +
geom_line(data=bestfit.invivo,aes(x=time,
y=Ccompartment,
color=color.factor,
shape = shape.factor))
p
p<-p+ geom_point(data=this.compound.data,
aes(x=Time, y=Value,
color=color.factor,
shape=shape.factor),
size=3)
p
p<-p+ scale_x_continuous(limits = c(min.time,max.time))
p
p<-p+scale_y_log10(label=scientific_10,limits=c(min.conc,max.conc))
p
p<-p+scale_color_manual(values=colorvals)
p
p<-p+   xlab("Time (h)") + ylab("Concentration (mg/L)") +
theme_bw() +
theme(aspect.ratio = 1)
p
junk <- plot_conctime(PK.fit.table=PK.fit.table.1comp.test[[1]],
data.set=PK.fit.table.1comp.test[[2]],
model="1compartment")
junk <- plot_conctime(PK.fit.table=PK.fit.table.1comp.test[[1]],
data.set=PK.fit.table.1comp.test[[2]],
model="1compartment")
any(is.finite(this.graph.fits$AIC))
p
junk <- plot_conctime(PK.fit.table=PK.fit.table.1comp.new[[1]],
data.set=PK.fit.table.1comp.new[[2]],
model="1compartment")
any(is.finite(this.graph.fits$AIC))
junk <- plot_conctime(PK.fit.table=PK.fit.table.1comp.test[[1]],
data.set=PK.fit.table.1comp.test[[2]],
model="1compartment")
junk <- plot_conctime(PK.fit.table=PK.fit.table.1comp.test[[1]],
data.set=PK.fit.table.1comp.test[[2]],
model="1compartment")
(any(is.finite(this.graph.fits$AIC)))
View(this.graph.fits)
junk <- plot_conctime(PK.fit.table=PK.fit.table.1comp.test[[1]],
data.set=PK.fit.table.1comp.test[[2]],
model="1compartment")
p <- ggplot2::ggplot(data=this.compound.data) +
ggtitle(paste(this.compound," (",model,"): Optimizer Failed, No Curve Fit",sep=""))+
geom_point(aes(x=Time, y=Value, color=color.factor, shape=shape.factor), size=3)
p
dev.new()
p
p<-p+ facet_wrap(facets=~vars(plot.split.factor), scales="free") +
scale_x_continuous(limits = c(min.time,max.time)) +
scale_y_log10(label=scientific_10,limits=c(min.conc,max.conc)) +
scale_color_manual(values=colorvals) +
xlab("Time (h)") + ylab("Concentration (mg/L)") +
theme_bw() +
theme(aspect.ratio = 1)
p
p <- ggplot2::ggplot(data=this.compound.data) +
ggtitle(paste(this.compound," (",model,"): Optimizer Failed, No Curve Fit",sep=""))+
geom_point(aes(x=Time, y=Value, color=color.factor, shape=shape.factor), size=3)
p
p<-p+facet_wrap(facets=~vars(plot.split.factor), scales="free")
p
devtools::load_all(".")
debug(plot_conctime)
junk <- plot_conctime(PK.fit.table=PK.fit.table.1comp.test[[1]],
data.set=PK.fit.table.1comp.test[[2]],
model="1compartment")
dev.new()
p
View(new_data_reformat_test)
View(new_data_test)
View(PK.fit.table.1comp.new.test)
View(PK.fit.table.1comp.test)
junk <- plot_conctime(PK.fit.table=PK.fit.table.1comp.new,
data.set=new_data_reformat,
model="1compartment")
system.time(PK.fit.table.1comp.new <- invivoPKfit::fit_all(
data.set=new_data,
model="1compartment",
modelfun= "analytic",
compound.col = "analyte_name_original",
cas.col = "dsstox_casrn",
reference.col = "fk_extraction_document_id",
species.col = "species",
species.weight.col = "weight_kg",
species.weight.units.default = "kg",
dose.col = "dose_level_normalized",
time.col = "time_hr",
time.units.default = "hr",
media.col = "conc_medium_normalized",
media.units.default = "normalized",
value.col = "conc",
units.default = NA,
route.col = "administration_route_normalized",
source.col = "fk_reference_document_id",
loq.default = NA,
subject.default = NA,
info.default= NA,
series.col = "fk_series_id"
))
junk <- plot_conctime(PK.fit.table=PK.fit.table.1comp.test[[1]],
data.set=PK.fit.table.1comp.test[[2]],
model="1compartment")
junk <- plot_conctime(PK.fit.table=PK.fit.table.1comp.new[[1]],
data.set=PK.fit.table.1comp.new[[2]],
model="1compartment")
debug(plot_conctime)
junk <- plot_conctime(PK.fit.table=PK.fit.table.1comp.new[[1]],
data.set=PK.fit.table.1comp.new[[2]],
model="1compartment")
dev.new()
p
View(data.set)
junk <- plot_conctime(PK.fit.table=PK.fit.table.1comp.new[[1]],
data.set=PK.fit.table.1comp.new[[2]],
model="1compartment")
devtools::load_all(".")
junk <- plot_conctime(PK.fit.table=PK.fit.table.1comp.new[[1]],
data.set=PK.fit.table.1comp.new[[2]],
model="1compartment")
traceback()
PK.fit.table.1.comp.new.list<-PK.fit.table.1comp.new
rm(PK.fit.table.1comp.new)
junk <- plot_conctime(PK.fit.table=PK.fit.table.1comp.new,
data.set=new_data_reformat,
model="1compartment")
debug(plot_conctime)
junk <- plot_conctime(PK.fit.table=PK.fit.table.1comp.new,
data.set=new_data_reformat,
model="1compartment")
View(this.compound.data)
devtools::load_all(".")
debug(plot_cocn)
debug(plot_conctime)
junk <- plot_conctime(PK.fit.table=PK.fit.table.1comp.new,
data.set=new_data_reformat,
model="1compartment")
undebug(plot_conctime)
junk <- plot_conctime(PK.fit.table=PK.fit.table.1comp.new,
data.set=new_data_reformat,
model="1compartment")
junk <- plot_conctime(PK.fit.table=PK.fit.table.1comp.new[[1]],
data.set=PK.fit.table.1comp.new[[2]],
model="1compartment")
junk <- plot_conctime(PK.fit.table=PK.fit.table.1comp.new.list[[1]],
data.set=PK.fit.table.1.comp.new.list[[2]],
model="1compartment")
junk <- plot_conctime(PK.fit.table=PK.fit.table.1.comp.new.list[[1]],
data.set=PK.fit.table.1.comp.new.list[[2]],
model="1compartment")
view(PK.fit.table.1.comp.new.list[[2]])
new_data_subset <- new_data %>% filter(dsstox_casrn != "518-82-1")
system.time(PK.fit.table.1comp.new.subset <- invivoPKfit::fit_all(
data.set=new_data_subset,
model="1compartment",
modelfun= "analytic",
compound.col = "analyte_name_original",
cas.col = "dsstox_casrn",
reference.col = "fk_extraction_document_id",
species.col = "species",
species.weight.col = "weight_kg",
species.weight.units.default = "kg",
dose.col = "dose_level_normalized",
time.col = "time_hr",
time.units.default = "hr",
media.col = "conc_medium_normalized",
media.units.default = "normalized",
value.col = "conc",
units.default = NA,
route.col = "administration_route_normalized",
source.col = "fk_reference_document_id",
loq.default = NA,
subject.default = NA,
info.default= NA,
series.col = "fk_series_id"
))
new_data_subset <- new_data %>% filter(dsstox_casrn == "518-82-1")
system.time(PK.fit.table.1comp.new.subset <- invivoPKfit::fit_all(
data.set=new_data_subset,
model="1compartment",
modelfun= "analytic",
compound.col = "analyte_name_original",
cas.col = "dsstox_casrn",
reference.col = "fk_extraction_document_id",
species.col = "species",
species.weight.col = "weight_kg",
species.weight.units.default = "kg",
dose.col = "dose_level_normalized",
time.col = "time_hr",
time.units.default = "hr",
media.col = "conc_medium_normalized",
media.units.default = "normalized",
value.col = "conc",
units.default = NA,
route.col = "administration_route_normalized",
source.col = "fk_reference_document_id",
loq.default = NA,
subject.default = NA,
info.default= NA,
series.col = "fk_series_id"
))
View(PK.fit.table.1comp.new.subset)
junk <- plot_conctime(PK.fit.table=PK.fit.table.1comp.new.subset[[1]],
data.set=PK.fit.table.1comp.new.subset[[2]],
model="1compartment")
debug(plot_conctime)
junk <- plot_conctime(PK.fit.table=PK.fit.table.1comp.new.subset[[1]],
data.set=PK.fit.table.1comp.new.subset[[2]],
model="1compartment")
dev.new()
p
p
new_data_subset <- new_data %>% filter(dsstox_casrn != "518-82-1")
system.time(PK.fit.table.1comp.new.subset <- invivoPKfit::fit_all(
data.set=new_data_subset,
model="1compartment",
modelfun= "analytic",
compound.col = "analyte_name_original",
cas.col = "dsstox_casrn",
reference.col = "fk_extraction_document_id",
species.col = "species",
species.weight.col = "weight_kg",
species.weight.units.default = "kg",
dose.col = "dose_level_normalized",
time.col = "time_hr",
time.units.default = "hr",
media.col = "conc_medium_normalized",
media.units.default = "normalized",
value.col = "conc",
units.default = NA,
route.col = "administration_route_normalized",
source.col = "fk_reference_document_id",
loq.default = NA,
subject.default = NA,
info.default= NA,
series.col = "fk_series_id"
))
junk <- plot_conctime(PK.fit.table=PK.fit.table.1comp.new.subset[[1]],
data.set=PK.fit.table.1comp.new.subset[[2]],
model="1compartment")
view(PK.fit.table.1comp.new.subset[[2]])
traceback()
new_data_subset <- new_data %>% filter(dsstox_casrn != "678-39-7")
system.time(PK.fit.table.1comp.new.subset <- invivoPKfit::fit_all(
data.set=new_data_subset,
model="1compartment",
modelfun= "analytic",
compound.col = "analyte_name_original",
cas.col = "dsstox_casrn",
reference.col = "fk_extraction_document_id",
species.col = "species",
species.weight.col = "weight_kg",
species.weight.units.default = "kg",
dose.col = "dose_level_normalized",
time.col = "time_hr",
time.units.default = "hr",
media.col = "conc_medium_normalized",
media.units.default = "normalized",
value.col = "conc",
units.default = NA,
route.col = "administration_route_normalized",
source.col = "fk_reference_document_id",
loq.default = NA,
subject.default = NA,
info.default= NA,
series.col = "fk_series_id"
))
junk <- plot_conctime(PK.fit.table=PK.fit.table.1comp.new.subset[[1]],
data.set=PK.fit.table.1comp.new.subset[[2]],
model="1compartment")
view(PK.fit.table.1comp.new.subset[[2]])
PK.fit.table.1comp.subset[[1]] %>% filter(CAS != "97-54-1")
PK.fit.table.1comp.subset[[2]] %>% filter(CAS != "97-54-1")
PK.fit.table.1comp.new.subset[[1]] %>% filter(CAS != "97-54-1")
PK.fit.table.1comp.new.subset[[2]] %>% filter(CAS != "97-54-1")
junk <- plot_conctime(PK.fit.table=PK.fit.table.1comp.new.subset[[1]],
data.set=PK.fit.table.1comp.new.subset[[2]],
model="1compartment")
list1 <- PK.fit.table.1comp.new.subset[[1]] %>% filter(CAS != "97-54-1")
list2 <- PK.fit.table.1comp.new.subset[[2]] %>% filter(CAS != "97-54-1")
junk <- plot_conctime(PK.fit.table=list1,
data.set=list2,
model="1compartment")
PK.fit.table.1comp.new.subset[[1]] %>% filter(CAS != "97-54-1")
PK.fit.table.1comp.new.subset[[2]] %>% filter(CAS != "97-54-1")
junk <- plot_conctime(PK.fit.table=PK.fit.table.1comp.new.subset[[1]],
data.set=PK.fit.table.1comp.new.subset[[2]],
model="1compartment")
view(PK.fit.table.1comp.new.subset[[2]])
list1 <- PK.fit.table.1comp.new.subset[[1]] %>% filter(CAS != "97-54-1")
View(list1)
junk <- plot_conctime(PK.fit.table=PK.fit.table.1comp.new.subset[[1]],
data.set=PK.fit.table.1comp.new.subset[[2]],
model="1compartment")
PK.fit.table.1comp.new.subset[[1]] %>% filter(CAS != "97-54-1")
view(PK.fit.table.1comp.new.subset[[1]])
list1 <- PK.fit.table.1comp.new.subset[[1]] %>% filter(CAS != "97-54-1")
list2 <- PK.fit.table.1comp.new.subset[[2]] %>% filter(CAS != "97-54-1")
junk <- plot_conctime(PK.fit.table=list1,
data.set=list2,
model="1compartment")
junk <- plot_conctime(PK.fit.table=PK.fit.table.1comp.new.subset[[1]] %>% filter(CAS != "97-54-1"),
data.set=PK.fit.table.1comp.new.subset[[2]] %>% filter(CAS != "97-54-1"),
model="1compartment")
new_data_subset <- new_data %>% filter(dsstox_casrn != "97-54-1")
system.time(PK.fit.table.1comp.new.subset <- invivoPKfit::fit_all(
data.set=new_data_subset,
model="1compartment",
modelfun= "analytic",
compound.col = "analyte_name_original",
cas.col = "dsstox_casrn",
reference.col = "fk_extraction_document_id",
species.col = "species",
species.weight.col = "weight_kg",
species.weight.units.default = "kg",
dose.col = "dose_level_normalized",
time.col = "time_hr",
time.units.default = "hr",
media.col = "conc_medium_normalized",
media.units.default = "normalized",
value.col = "conc",
units.default = NA,
route.col = "administration_route_normalized",
source.col = "fk_reference_document_id",
loq.default = NA,
subject.default = NA,
info.default= NA,
series.col = "fk_series_id"
))
junk <- plot_conctime(PK.fit.table=PK.fit.table.1comp.new.subset[[1]],
data.set=PK.fit.table.1comp.new.subset[[2]],
model="1compartment")
view(PK.fit.table.1comp.new.subset[[1]])
new_data_subset <- new_data %>% filter(dsstox_casrn != "518-82-1")
new_data_subset <- new_data %>% filter(dsstox_casrn != "678-39-7")
new_data_subset <- new_data %>% filter(dsstox_casrn != "97-54-1")
View(new_data_subset)
view(new_data)
new_data_subset <- new_data %>% filter(dsstox_casrn != "518-82-1")
new_data_subset <- new_data %>% filter(dsstox_casrn != "678-39-7")
new_data_subset <- new_data %>% filter(dsstox_casrn != "97-54-1")
View(new_data_subset)
new_data_subset <- new_data %>% filter(dsstox_casrn != "678-39-7")
new_data_subset <- new_data %>% filter(dsstox_casrn != "97-54-1")
new_data_subset <- new_data %>% filter(dsstox_casrn != "678-39-7")
View(new_data_subset)
rm(new_data_subset)
### remove data that causes plot to crash
new_data_subset <- new_data %>% filter(dsstox_casrn != "518-82-1")
new_data_subset <- new_data %>% filter(dsstox_casrn != "678-39-7")
new_data_subset <- new_data %>% filter(dsstox_casrn != "97-54-1")
system.time(PK.fit.table.1comp.new.subset <- invivoPKfit::fit_all(
data.set=new_data_subset,
model="1compartment",
modelfun= "analytic",
compound.col = "analyte_name_original",
cas.col = "dsstox_casrn",
reference.col = "fk_extraction_document_id",
species.col = "species",
species.weight.col = "weight_kg",
species.weight.units.default = "kg",
dose.col = "dose_level_normalized",
time.col = "time_hr",
time.units.default = "hr",
media.col = "conc_medium_normalized",
media.units.default = "normalized",
value.col = "conc",
units.default = NA,
route.col = "administration_route_normalized",
source.col = "fk_reference_document_id",
loq.default = NA,
subject.default = NA,
info.default= NA,
series.col = "fk_series_id"
))
junk <- plot_conctime(PK.fit.table=PK.fit.table.1comp.new.subset[[1]],
data.set=PK.fit.table.1comp.new.subset[[2]],
model="1compartment")
View(new_data_subset)
new_data_subset <- new_data %>% filter(dsstox_casrn != "518-82-1" |
dsstox_casrn != "678-39-7" |
dsstox_casrn != "97-54-1")
View(new_data_subset)
new_data_subset <- new_data %>% filter(dsstox_casrn != "518-82-1" |
dsstox_casrn != "678-39-7" |
dsstox_casrn != "97-54-1")
View(new_data_subset)
new_data_subset <- new_data %>% filter(dsstox_casrn != "518-82-1" |
dsstox_casrn != "678-39-7" |
dsstox_casrn != "97-54-1")
View(new_data_subset)
library(tidyverse)
list1 <- PK.fit.table.1comp.new.subset[[1]] %>% filter(CAS != "97-54-1")
list2 <- PK.fit.table.1comp.new.subset[[2]] %>% filter(CAS != "97-54-1")
list1 <- PK.fit.table.1comp.new.subset[[1]] %>% filter(CAS != "678-39-7")
list2 <- PK.fit.table.1comp.new.subset[[2]] %>% filter(CAS != "678-39-7")
list1 <- PK.fit.table.1comp.new.subset[[1]] %>% filter(CAS != "518-82-1")
list2 <- PK.fit.table.1comp.new.subset[[2]] %>% filter(CAS != "518-82-1")
View(list2)
junk <- plot_conctime(PK.fit.table=list1,
data.set=list2,
model="1compartment")
junk <- plot_conctime(PK.fit.table=list1,
data.set=list2,
model="1compartment")
class(list1)
class(list2)
list1 <- PK.fit.table.1comp.new.subset[[1]]
list2 <- PK.fit.table.1comp.new.subset[[2]]
junk <- plot_conctime(PK.fit.table=list1,
data.set=list2,
model="1compartment")
junk <- plot_conctime(PK.fit.table=list1,
data.set=list2,
model="1compartment")
View(PK.fit.table)
list1 <- PK.fit.table.1comp.new.subset[[1]] %>% filter(CAS != "97-54-1" | CAS != "678-39-7" | CAS != "518-82-1")
list2 <- PK.fit.table.1comp.new.subset[[2]] %>% filter(CAS != "97-54-1" | CAS != "678-39-7" | CAS != "518-82-1")
junk <- plot_conctime(PK.fit.table=list1,
data.set=list2,
model="1compartment")
View(PK.fit.table)
dev.new()
junk <- plot_conctime(PK.fit.table=list1,
data.set=list2,
model="1compartment")
list1 <- PK.fit.table.1comp.new.subset[[1]] %>% filter(CAS != "97-54-1" | CAS != "678-39-7" | CAS != "518-82-1")
list2 <- PK.fit.table.1comp.new.subset[[2]] %>% filter(CAS != "97-54-1" | CAS != "678-39-7" | CAS != "518-82-1")
junk <- plot_conctime(PK.fit.table=list1,
data.set=list2,
model="1compartment")
View(list1)
list1 <- PK.fit.table.1comp.new.subset[[1]] %>% filter(CAS != "97-54-1" | CAS != "678-39-7" | CAS != "518-82-1")
list2 <- PK.fit.table.1comp.new.subset[[2]] %>% filter(CAS != "97-54-1" | CAS != "678-39-7" | CAS != "518-82-1")
View(list1)
list1 <- PK.fit.table.1comp.new.subset[[1]] %>% filter(CAS != "97-54-1")
list1 <- list1 %>% filter(CAS != "678-39-7")
list1 <- list1 %>% filter(CAS != "518-82-1")
list1 <- PK.fit.table.1comp.new.subset[[2]] %>% filter(CAS != "97-54-1")
list1 <- list1 %>% filter(CAS != "678-39-7")
list1 <- list1 %>% filter(CAS != "518-82-1")
junk <- plot_conctime(PK.fit.table=list1,
data.set=list2,
model="1compartment")
View(list1)
View(PK.fit.table.1.comp.new.list)
View(PK.fit.table.1comp.new.subset)
View(PK.fit.table.1.comp.new.list)
View(PK.fit.table.1comp.new.subset)
View(PK.fit.table.1.comp.new.list)
new_data_subset <- new_data %>% filter(dsstox_casrn != "518-82-1")
new_data_subset <- new_data_subset %>% filter(dsstox_casrn != "678-39-7")
new_data_subset <- new_data_subset %>% filter(dsstox_casrn != "97-54-1")
### remove data that causes plot to crash
new_data_subset <- new_data %>% filter(dsstox_casrn != "518-82-1")
new_data_subset <- new_data_subset %>% filter(dsstox_casrn != "678-39-7")
new_data_subset <- new_data_subset %>% filter(dsstox_casrn != "97-54-1")
system.time(PK.fit.table.1comp.new.subset <- invivoPKfit::fit_all(
data.set=new_data_subset,
model="1compartment",
modelfun= "analytic",
compound.col = "analyte_name_original",
cas.col = "dsstox_casrn",
reference.col = "fk_extraction_document_id",
species.col = "species",
species.weight.col = "weight_kg",
species.weight.units.default = "kg",
dose.col = "dose_level_normalized",
time.col = "time_hr",
time.units.default = "hr",
media.col = "conc_medium_normalized",
media.units.default = "normalized",
value.col = "conc",
units.default = NA,
route.col = "administration_route_normalized",
source.col = "fk_reference_document_id",
loq.default = NA,
subject.default = NA,
info.default= NA,
series.col = "fk_series_id"
))
View(PK.fit.table.1comp.new.subset)
junk <- plot_conctime(PK.fit.table=PK.fit.table.1comp.new.subset[[1]],
data.set=PK.fit.table.1comp.new.subset[[2]],
model="1compartment")
save(PK.fit.table.1comp.new.subset, file = "data/PK.fit.table.1comp.new.subset.rda")
dev.off()
