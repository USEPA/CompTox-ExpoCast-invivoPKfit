#   geom_hline(yintercept = c(0.5, 2),
#              linetype = "dashed") +
#   scale_x_log10() +
#   scale_y_log10() +
#   labs(x = "Data Variability",
#        y = "Model Error") +
#   guides(fill = guide_legend(override.aes = list(size = 0.1)))
#
# ###################
# fill_legend1 <- get_legend(rect_p1)
# fill_legend2 <- get_legend(rect_p2)
# ##################
p <- ggplot(data = full_data,
mapping = aes(x = conc_norm, y = cp_norm)) +
annotate(geom = "rect", xmin = 0, xmax = 0.5, ymin = 2, ymax = Inf, alpha = 0.3, fill = "#86A397") +
annotate(geom = "rect", xmin = 0, xmax = 0.5, ymin = 0, ymax = 0.5, alpha = 0.3, fill = "#86A397") +
annotate(geom = "rect", xmin = 2, xmax = Inf, ymin = 0, ymax = 0.5, alpha = 0.3, fill = "#86A397") +
annotate(geom = "rect", xmin = 2, xmax = Inf, ymin = 2, ymax = Inf, alpha = 0.3, fill = "#86A397") +
annotate(geom = "rect", xmin = 0, xmax = 0.5, ymin = 0.5, ymax = 2, alpha = 0.3, fill = "#361D2E") +
annotate(geom = "rect", xmin = 2, xmax = Inf, ymin = 0.5, ymax = 2, alpha = 0.3, fill = "#361D2E") +
annotate(geom = "rect", xmin = 0.5, xmax = 2, ymin = 2, ymax = Inf, alpha = 0.3, fill = "#E1B07E") +
annotate(geom = "rect", xmin = 0.5, xmax = 2, ymin = 0, ymax = 0.5, alpha = 0.3, fill = "#E1B07E") +
annotate(geom = "rect", xmin = 0.5, xmax = 2, ymin = 0.5, ymax = 2.0, alpha = 0.5, fill = "black") +
theme_bw() +
theme(panel.spacing = unit(2, "lines")) +
geom_bin2d(bins = 100) +
scale_fill_distiller(palette = "Blues") +
geom_vline(xintercept = c(0.5, 2),
linetype = "dashed") +
geom_hline(yintercept = c(0.5, 2),
linetype = "dashed") +
scale_x_log10() +
scale_y_log10() +
labs(x = "Data Variability",
y = "Model Performance") +
facet_wrap(. ~ model)
p
# ##################
#
# data_p_final <- data_p +
#   # inset_element(fill_legend1, 0.1, 1, 0.5, 1) +
#   inset_element(fill_legend2, 0.6, 0.5, 0.7, 0.2, clip = TRUE)
#
# data_p_final
p
51+1+8+39
52+3+44+34
##################
##################
# pk_data <- cp_df_03012022
pk_data <- cp_df_03302022
cvt_data <- cvt_variability_df_03012022
##################
##################
row.names(pk_data) <- c()
cvt_data <- dplyr::select(cvt_data, -c("kelim",
"Vdist",
"Fgutabs",
"kgutabs"))
### split pk_data by model so you can properly join with raw data
model_split <- split(pk_data, pk_data$model)
cvt_data$Reference <- as.character(cvt_data$Reference)
cvt_data$type <- "1-Compartment"
full_data_1 <- left_join(cvt_data, model_split$`1compartment`)
cvt_data$type <- "2-Compartment"
full_data_2 <- left_join(cvt_data, model_split$`2compartment`)
cvt_data$type <- "Flat"
full_data_flat <- left_join(cvt_data, model_split$`flat`)
### put data back together
full_data <- rbind(full_data_1, full_data_2, full_data_flat)
full_data <- full_data %>%
filter(cp != 0)
full_data$AIC <- round(full_data$AIC, digits = 4)
full_data <- full_data %>%
distinct(Compound, Reference, model, conc_norm, AIC, cp_norm)
###
full_data <- full_data %>%
pivot_wider(names_from = model,
values_from = c(AIC, cp_norm)) %>%
unchop(everything())
full_data <- full_data %>% mutate(model = case_when(AIC_1compartment < AIC_2compartment &
AIC_1compartment < AIC_flat ~ "1compartment",
AIC_2compartment < AIC_1compartment &
AIC_2compartment < AIC_flat ~ "2compartment",
AIC_flat < AIC_1compartment &
AIC_flat < AIC_2compartment ~ "flat",
!is.na(AIC_1compartment) & is.na(AIC_2compartment) &
is.na(AIC_flat) ~ "1compartment",
!is.na(AIC_2compartment) & is.na(AIC_1compartment) &
is.na(AIC_flat) ~ "2compartment",
!is.na(AIC_flat) & is.na(AIC_1compartment) &
is.na(AIC_2compartment) ~ "flat",
is.na(AIC_1compartment) &
AIC_flat < AIC_2compartment ~ "flat",
is.na(AIC_1compartment) &
AIC_2compartment < AIC_flat ~ "2compartment",
is.na(AIC_2compartment) &
AIC_flat < AIC_1compartment ~ "flat",
is.na(AIC_2compartment) &
AIC_1compartment < AIC_flat ~ "1compartment",
is.na(AIC_flat) &
AIC_1compartment < AIC_2compartment ~"1compartment",
is.na(AIC_flat) &
AIC_2compartment <AIC_1compartment ~"2compartment"))
full_data <- full_data %>%
mutate(cp_norm = case_when(model == "1compartment" ~ cp_norm_1compartment,
model == "2compartment" ~ cp_norm_2compartment,
model == "flat" ~ cp_norm_flat))
# full_data <- full_data %>%
#   mutate(cp_norm = case_when(model == "1comparment" ~ cp_norm_1compartment,
#                              model == "2compartment" ~ cp_norm_2compartment))
# full_data$cp_norm[full_data$model == "2compartment"] <- full_data$cp_norm_2compartment
# full_data$cp_norm[full_data$model == "1compartment"] <- full_data$cp_norm_1compartment
# full_data <- full_data %>%
# mutate(across(everything(), ~ifelse(. == "", NA, as.character(.))))
# filter(Compound != "triclosan")
# filter(Compound != "tamoxifen")
###########
###########
###########
split_full_data <- split(full_data, full_data$model)
full_data_1 <- split_full_data$`1compartment`
### Find number of points in each plot panel for 1-compartment
full_data_1_center <- full_data_1 %>% filter(conc_norm >= 0.5 & conc_norm <= 2)
full_data_1_center <- full_data_1_center %>% filter(cp_norm >= 0.5 & cp_norm <= 2)
ratio_1_center <- nrow(full_data_1_center) / nrow(full_data_1 %>% filter(!is.na(cp_norm)))
full_data_1_green <- full_data_1 %>% filter(conc_norm < 0.5 | conc_norm > 2)
full_data_1_green <- full_data_1_green %>% filter(cp_norm < 0.5 | cp_norm > 2)
ratio_1_green <- nrow(full_data_1_green) / nrow(full_data_1 %>% filter(!is.na(cp_norm)))
full_data_1_gray <- full_data_1 %>% filter(conc_norm < 0.5 | conc_norm > 2)
full_data_1_gray <- full_data_1_gray %>% filter(cp_norm >= 0.5 & cp_norm <= 2)
ratio_1_gray <- nrow(full_data_1_gray) / nrow(full_data_1 %>% filter(!is.na(cp_norm)))
full_data_1_tan <- full_data_1 %>% filter(conc_norm >= 0.5 & conc_norm <= 2)
full_data_1_tan <- full_data_1_tan %>% filter(cp_norm < 0.5 | cp_norm > 2)
ratio_1_tan <- nrow(full_data_1_tan) / nrow(full_data_1 %>% filter(!is.na(cp_norm)))
###########
###########
full_data_2 <- split_full_data$`2compartment`
### Find number of points in each plot panel for 2-compartment
full_data_2_center <- full_data_2 %>% filter(conc_norm >= 0.5 & conc_norm <= 2)
full_data_2_center <- full_data_2_center %>% filter(cp_norm >= 0.5 & cp_norm <= 2)
ratio_2_center <- nrow(full_data_2_center) / nrow(full_data_2 %>% filter(!is.na(cp_norm)))
full_data_2_green <- full_data_2 %>% filter(conc_norm < 0.5 | conc_norm > 2)
full_data_2_green <- full_data_2_green %>% filter(cp_norm < 0.5 | cp_norm > 2)
ratio_2_green <- nrow(full_data_2_green) / nrow(full_data_2 %>% filter(!is.na(cp_norm)))
full_data_2_gray <- full_data_2 %>% filter(conc_norm < 0.5 | conc_norm > 2)
full_data_2_gray <- full_data_2_gray %>% filter(cp_norm >= 0.5 & cp_norm <= 2)
ratio_2_gray <- nrow(full_data_2_gray) / nrow(full_data_2 %>% filter(!is.na(cp_norm)))
full_data_2_tan <- full_data_2 %>% filter(conc_norm >= 0.5 & conc_norm <= 2)
full_data_2_tan <- full_data_2_tan %>% filter(cp_norm < 0.5 | cp_norm > 2)
ratio_2_tan <- nrow(full_data_2_tan) / nrow(full_data_2 %>% filter(!is.na(cp_norm)))
###########
###########
full_data_flat <- split_full_data$`flat`
### Find number of points in each plot panel for 2-compartment
full_data_flat_center <- full_data_flat %>% filter(conc_norm >= 0.5 & conc_norm <= 2)
full_data_flat_center <- full_data_flat_center %>% filter(cp_norm >= 0.5 & cp_norm <= 2)
ratio_flat_center <- nrow(full_data_flat_center) / nrow(full_data_flat %>% filter(!is.na(cp_norm)))
full_data_flat_green <- full_data_flat %>% filter(conc_norm < 0.5 | conc_norm > 2)
full_data_flat_green <- full_data_flat_green %>% filter(cp_norm < 0.5 | cp_norm > 2)
ratio_flat_green <- nrow(full_data_flat_green) / nrow(full_data_flat %>% filter(!is.na(cp_norm)))
full_data_flat_gray <- full_data_flat %>% filter(conc_norm < 0.5 | conc_norm > 2)
full_data_flat_gray <- full_data_flat_gray %>% filter(cp_norm >= 0.5 & cp_norm <= 2)
ratio_flat_gray <- nrow(full_data_flat_gray) / nrow(full_data_flat %>% filter(!is.na(cp_norm)))
full_data_flat_tan <- full_data_flat %>% filter(conc_norm >= 0.5 & conc_norm <= 2)
full_data_flat_tan <- full_data_flat_tan %>% filter(cp_norm < 0.5 | cp_norm > 2)
ratio_flat_tan <- nrow(full_data_flat_tan) / nrow(full_data_flat %>% filter(!is.na(cp_norm)))
###########
###########
###########
# rect_df1 <- data.frame(xmin = c(0, 0, 2, 2, 0, 2, 0.5, 0.5),
#                       xmax = c(0.5, 0.5, Inf, Inf, 0.5, Inf, 2, 2),
#                       ymin = c(2, 0, 0, 2, 0.5, 0.5, 2, 0),
#                       ymax = c(Inf, 0.5, 0.5, Inf, 2, 2, Inf, 0.5),
#                       panel_key = c(paste("Poor Fit, Outlier Data",
#                                           paste("(", round(100 * ratio_1_green, digits = 1), "%", ")", sep = ""),
#                                           sep = " "),
#                                     paste("Poor Fit, Outlier Data",
#                                           paste("(", round(100 * ratio_1_green, digits = 1), "%", ")", sep = ""),
#                                           sep = " "),
#                                     paste("Poor Fit, Outlier Data",
#                                           paste("(", round(100 * ratio_1_green, digits = 1), "%", ")", sep = ""),
#                                           sep = " "),
#                                     paste("Poor Fit, Outlier Data",
#                                           paste("(", round(100 * ratio_1_green, digits = 1), "%", ")", sep = ""),
#                                           sep = " "),
#                                     paste("Good Fit, Outlier Data",
#                                           paste("(", round(100 * ratio_1_tan, digits = 1), "%", ")", sep = ""),
#                                           sep = " "),
#                                     paste("Good Fit, Outlier Data",
#                                           paste("(", round(100 * ratio_1_tan, digits = 1), "%", ")", sep = ""),
#                                           sep = " "),
#                                    paste("Poor Fit, Typical Data",
#                                           paste("(", round(100 * ratio_1_gray, digits = 1), "%", ")", sep = ""),
#                                           sep = " "),
#                                    paste("Poor Fit, Typical Data",
#                                           paste("(", round(100 * ratio_1_gray, digits = 1), "%", ")", sep = ""),
#                                           sep = " ")))
#
# rect_df2 <- data.frame(xmin = c(0, 0, 2, 2, 0, 2, 0.5, 0.5),
#                       xmax = c(0.5, 0.5, Inf, Inf, 0.5, Inf, 2, 2),
#                       ymin = c(2, 0, 0, 2, 0.5, 0.5, 2, 0),
#                       ymax = c(Inf, 0.5, 0.5, Inf, 2, 2, Inf, 0.5),
#                       panel_key = c(paste("Poor Fit, Outlier Data",
#                                           paste("(", round(100 * ratio_2_green, digits = 1), "%", ")", sep = ""),
#                                           sep = " "),
#                                     paste("Poor Fit, Outlier Data",
#                                           paste("(", round(100 * ratio_2_green, digits = 1), "%", ")", sep = ""),
#                                           sep = " "),
#                                     paste("Poor Fit, Outlier Data",
#                                           paste("(", round(100 * ratio_2_green, digits = 1), "%", ")", sep = ""),
#                                           sep = " "),
#                                     paste("Poor Fit, Outlier Data",
#                                           paste("(", round(100 * ratio_2_green, digits = 1), "%", ")", sep = ""),
#                                           sep = " "),
#                                     paste("Good Fit, Outlier Data",
#                                           paste("(", round(100 * ratio_2_tan, digits = 1), "%", ")", sep = ""),
#                                           sep = " "),
#                                     paste("Good Fit, Outlier Data",
#                                           paste("(", round(100 * ratio_2_tan, digits = 1), "%", ")", sep = ""),
#                                           sep = " "),
#                                    paste("Poor Fit, Typical Data",
#                                           paste("(", round(100 * ratio_2_gray, digits = 1), "%", ")", sep = ""),
#                                           sep = " "),
#                                    paste("Poor Fit, Typical Data",
#                                           paste("(", round(100 * ratio_2_gray, digits = 1), "%", ")", sep = ""),
#                                           sep = " ")))
#
#
# rect_p1 <- ggplot() +
#   geom_rect(data = rect_df1, aes(xmin = xmin,
#                                 ymin = ymin,
#                                 xmax = xmax,
#                                 ymax = ymax,
#                                 fill = panel_key),
#             alpha = 0.3, inherit.aes = FALSE) +
#   scale_fill_manual(name = "Panel Key",
#                     values = c("#361D2E",
#                                "#86A397",
#                                "#E1B07E")) +
#   theme_bw() +
#   theme(panel.spacing = unit(2, "lines")) +
#   geom_vline(xintercept = c(0.5, 2),
#              linetype = "dashed") +
#   geom_hline(yintercept = c(0.5, 2),
#              linetype = "dashed") +
#   scale_x_log10() +
#   scale_y_log10() +
#   labs(x = "Data Variability",
#        y = "Model Error") +
#   guides(fill = guide_legend(override.aes = list(size = 0.1)))
#
# rect_p2 <- ggplot() +
#   geom_rect(data = rect_df2, aes(xmin = xmin,
#                                 ymin = ymin,
#                                 xmax = xmax,
#                                 ymax = ymax,
#                                 fill = panel_key),
#             alpha = 0.3, inherit.aes = FALSE) +
#   scale_fill_manual(name = "Panel Key",
#                     values = c("#361D2E",
#                                "#86A397",
#                                "#E1B07E")) +
#   theme_bw() +
#   theme(panel.spacing = unit(2, "lines")) +
#   geom_vline(xintercept = c(0.5, 2),
#              linetype = "dashed") +
#   geom_hline(yintercept = c(0.5, 2),
#              linetype = "dashed") +
#   scale_x_log10() +
#   scale_y_log10() +
#   labs(x = "Data Variability",
#        y = "Model Error") +
#   guides(fill = guide_legend(override.aes = list(size = 0.1)))
#
# ###################
# fill_legend1 <- get_legend(rect_p1)
# fill_legend2 <- get_legend(rect_p2)
# ##################
p <- ggplot(data = full_data,
mapping = aes(x = conc_norm, y = cp_norm)) +
annotate(geom = "rect", xmin = 0, xmax = 0.5, ymin = 2, ymax = Inf, alpha = 0.3, fill = "#86A397") +
annotate(geom = "rect", xmin = 0, xmax = 0.5, ymin = 0, ymax = 0.5, alpha = 0.3, fill = "#86A397") +
annotate(geom = "rect", xmin = 2, xmax = Inf, ymin = 0, ymax = 0.5, alpha = 0.3, fill = "#86A397") +
annotate(geom = "rect", xmin = 2, xmax = Inf, ymin = 2, ymax = Inf, alpha = 0.3, fill = "#86A397") +
annotate(geom = "rect", xmin = 0, xmax = 0.5, ymin = 0.5, ymax = 2, alpha = 0.3, fill = "#361D2E") +
annotate(geom = "rect", xmin = 2, xmax = Inf, ymin = 0.5, ymax = 2, alpha = 0.3, fill = "#361D2E") +
annotate(geom = "rect", xmin = 0.5, xmax = 2, ymin = 2, ymax = Inf, alpha = 0.3, fill = "#E1B07E") +
annotate(geom = "rect", xmin = 0.5, xmax = 2, ymin = 0, ymax = 0.5, alpha = 0.3, fill = "#E1B07E") +
annotate(geom = "rect", xmin = 0.5, xmax = 2, ymin = 0.5, ymax = 2.0, alpha = 0.5, fill = "black") +
theme_bw() +
theme(panel.spacing = unit(2, "lines")) +
geom_bin2d(bins = 100) +
scale_fill_distiller(palette = "Blues") +
geom_vline(xintercept = c(0.5, 2),
linetype = "dashed") +
geom_hline(yintercept = c(0.5, 2),
linetype = "dashed") +
scale_x_log10() +
scale_y_log10() +
labs(x = "Data Variability",
y = "Model Performance") +
facet_wrap(. ~ model)
p
# ##################
#
# data_p_final <- data_p +
#   # inset_element(fill_legend1, 0.1, 1, 0.5, 1) +
#   inset_element(fill_legend2, 0.6, 0.5, 0.7, 0.2, clip = TRUE)
#
# data_p_final
53+2.5+10+35
p
devtools::load_all(".")
devtools::load_all(".")
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(warning = FALSE)
knitr::opts_chunk$set(results = TRUE)
knitr::opts_chunk$set(message = FALSE)
data <- read.csv("inst/ext/cvt_query_for_john_27may2021_v2.csv")
data <- read.csv("inst/ext/cvt_query_for_john_27may2021_v2.csv")
data <- read.csv("inst/ext/cvtdb_invivopkfit_02242022.csv")
data <- read.csv("inst/ext/cvt_query_for_john_27may2021_v2.csv")
data <- read.csv("inst/ext/cvtdb_invivopkfit_02242022.csv")
### fix compound names
data$analyte_name_original[data$analyte_name_original == "Methyleugonal "] <- "Methyleugonal"
data$analyte_name_original[data$analyte_name_original == "benzo[a]pyrene"] <- "benzo(a)pyrene"
data$analyte_name_original[data$analyte_name_original == "2,4-D"] <- "2,4-Dichlorophenoxyacetic acid"
data$analyte_name_original[data$analyte_name_original == "Diclofenac"] <- "Hexobarbital"
data$analyte_name_original[data$analyte_name_original == "Pentadecafluorooctanoic acid"] <- "Perfluorooctanoic acid"
### make fk_reference_document equal fk_extraction document if fk_reference_document is NULL
data$fk_reference_document_id[data$fk_reference_document_id == "NULL"] <- data$fk_extraction_document_id[data$fk_reference_document_id == "NULL"]
### do 1-Compartment fit
system.time(PK.fit.table.1comp <- fit_all(
data.set = data,
model = "1compartment",
modelfun = "analytic",
compound.col = "analyte_name_original",
cas.col = "dsstox_casrn",
reference.col = "fk_reference_document_id",
species.col = "species",
species.weight.col = "weight_kg",
species.weight.units.default = "kg",
dose.col = "dose_level_normalized",
time.col = "time_hr",
time.units.default = "hr",
media.col = "conc_medium_normalized",
media.units.default = "normalized",
value.col = "conc",
units.default = NA,
route.col = "administration_route_normalized",
source.col = "document_id",
loq.default = NA,
subject.default = NA,
info.default = NA,
ratio.data.to.dose = 0.001
))
system.time(PK.fit.table.1comp <- fit_all(
data.set = data,
model = "1compartment",
modelfun = "analytic",
compound.col = "analyte_name_original",
cas.col = "dsstox_casrn",
reference.col = "fk_reference_document_id",
species.col = "species",
species.weight.col = "weight_kg",
species.weight.units.default = "kg",
dose.col = "dose_level_normalized",
time.col = "time_hr",
time.units.default = "hr",
media.col = "conc_medium_normalized",
media.units.default = "normalized",
value.col = "conc",
units.default = NA,
route.col = "administration_route_normalized",
source.col = "document_id",
loq.default = NA,
subject.default = NA,
info.default = NA,
ratio.data.to.dose = 0.001
))
debug(rename_columns)
system.time(PK.fit.table.1comp <- fit_all(
data.set = data,
model = "1compartment",
modelfun = "analytic",
compound.col = "analyte_name_original",
cas.col = "dsstox_casrn",
reference.col = "fk_reference_document_id",
species.col = "species",
species.weight.col = "weight_kg",
species.weight.units.default = "kg",
dose.col = "dose_level_normalized",
time.col = "time_hr",
time.units.default = "hr",
media.col = "conc_medium_normalized",
media.units.default = "normalized",
value.col = "conc",
units.default = NA,
route.col = "administration_route_normalized",
source.col = "document_id",
loq.default = NA,
subject.default = NA,
info.default = NA,
ratio.data.to.dose = 0.001
))
devtools::load_all(".")
system.time(PK.fit.table.1comp <- fit_all(
data.set = data,
model = "1compartment",
modelfun = "analytic",
compound.col = "analyte_name_original",
cas.col = "dsstox_casrn",
reference.col = "fk_reference_document_id",
species.col = "species",
species.weight.col = "weight_kg",
species.weight.units.default = "kg",
dose.col = "dose_level_normalized",
time.col = "time_hr",
time.units.default = "hr",
media.col = "conc_medium_normalized",
media.units.default = "normalized",
value.col = "conc",
units.default = NA,
route.col = "administration_route_normalized",
source.col = "document_id",
loq.default = NA,
subject.default = NA,
info.default = NA,
ratio.data.to.dose = 0.001
))
View(data)
system.time(PK.fit.table.1comp <- fit_all(
data.set = data,
model = "1compartment",
model_fun = "analytic",
compound_col = "analyte_name_original",
cas_col = "dsstox_casrn",
dtxsid_col = "dtsstox_substance_id"
reference_col = "fk_reference_document_id",
species_col = "species",
species_weight.col = "weight_kg",
species_weight.units.default = "kg",
dose_col = "dose_level_normalized",
time_col = "time_hr",
time_units_default = "hr",
media_col = "conc_medium_normalized",
media_units_default = "normalized",
conc_col = "conc",
conc_units_default = NA,
route_col = "administration_route_normalized",
source_col = "document_id",
loq_default = NA,
subject_default = NA,
info_default = NA,
ratio_data_to_dose = 0.001,
loq_default = NA,
loq_units_default= NA
))
devtools::load_all(".")
system.time(PK.fit.table.1comp <- fit_all(
data.set = data,
model = "1compartment",
modelfun = "analytic",
compound.col = "analyte_name_original",
cas.col = "dsstox_casrn",
reference.col = "fk_reference_document_id",
species.col = "species",
species.weight.col = "weight_kg",
species.weight.units.default = "kg",
dose.col = "dose_level_normalized",
time.col = "time_hr",
time.units.default = "hr",
media.col = "conc_medium_normalized",
media.units.default = "normalized",
value.col = "conc",
units.default = NA,
route.col = "administration_route_normalized",
source.col = "document_id",
loq.default = NA,
subject.default = NA,
info.default = NA,
ratio.data.to.dose = 0.001
))
debug(analzye_pk_data)
debug(analyze_pk_data)
devtools::load_all(".")
system.time(PK.fit.table.1comp <- fit_all(
data.set = data,
model = "1compartment",
modelfun = "analytic",
compound.col = "analyte_name_original",
cas.col = "dsstox_casrn",
reference.col = "fk_reference_document_id",
species.col = "species",
species.weight.col = "weight_kg",
species.weight.units.default = "kg",
dose.col = "dose_level_normalized",
time.col = "time_hr",
time.units.default = "hr",
media.col = "conc_medium_normalized",
media.units.default = "normalized",
value.col = "conc",
units.default = NA,
route.col = "administration_route_normalized",
source.col = "document_id",
loq.default = NA,
subject.default = NA,
info.default = NA,
ratio.data.to.dose = 0.001
))
View(DT)
